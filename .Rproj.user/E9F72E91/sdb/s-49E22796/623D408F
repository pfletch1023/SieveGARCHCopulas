{
    "contents" : "# Paul Fletcher-Hill\n# ECON 371\n# Problem Set 3\n\n# Setup\nsetwd(\"~/Google Drive/ECON 371/ps3\")\nlibrary(fBasics)\nlibrary(fGarch)\n\n# 3)  Use the S&P 500 index to represent the US Market. Obtain the time-varying\n#     betas for the Abbott Laboratories stock. The sample period is from January 2,\n#     2001 to December 31, 2010. The data are available from CRSP or Yahoo Finance,\n#     or the file d-abtsp-0110.txt.\n\n# Data import\nda <- read.table(\"d-abtsp-0110.txt\", header=T)\nnames(da)\nhead(da)\nabt <- log(da$abt + 1) # log return of ABT\nsp5 <- log(da$sprtn + 1) # log return of S&P 500\n\n# Covariance calculation\nm.plus <- garchFit(~1 + garch(1,1), data=(abt + sp5), trace=F) # ABT + S&P 500\nm.minus <- garchFit(~1 + garch(1,1), data=(abt - sp5), trace=F) # ABT - S&P 500\nm.sp5 <- garchFit(~1 + garch(1,1), data=sp5, trace=F) # S&P 500\nv.plus <- m.plus@h.t # Conditional variance of m.plus\nv.minus <- m.minus@h.t # Conditional variance of m.minus\nv.sp5 <- m.sp5@h.t # Conditional variance of S&P 500\n\n# Beta calculation\nbeta <- (v.plus - v.minus) / (4 * v.sp5)\nlm.fitted <- lm(abt ~ sp5) # abt ~ sp5 linear model\nsummary(lm.fitted) # sp5 coeff: 0.5331\nts.plot(beta, type=\"l\")\nabline(h = as.numeric(coef(lm.fitted)[2]), col=\"red\")\n\n# 4)  Suppose that a portfolio consists of three US stocks, namely, Alcoa, American\n#     Express, and Abbott Laboratories. The daily simple returns are available\n#     from the file d-a2a-0110.txt. Use GARCH models to obtain the conditional\n#     covariance matrices of the stocks for the period from December 29, 2008 to\n#     December 31, 2010. Obtain the weights and the resulting volatility of the\n#     minimum variance portfolio for the period. Plot the weights and the volatilities\n#     similar to those in Figures 5.7 and 5.8.\n\n# Data import\n# Assume table contains absolute returns\nda <- read.table(\"d-a2a-0110.txt\", header=T)\naa <- log(da$AA + 1) # Alcoa: AA\naxp <- log(da$AXP + 1) # American Express: AXP\nabt <- log(da$ABT + 1) # Abbott Laboraties: ABT\nrtns <- cbind(aa, axp, abt) # Collect log returns\n\nsource(\"gmvp.R\")\nm1 <- gmvp(rtns, start=2012)\ntokeepforever <- m1\nnames(m1)\n\n# Weight Plot\nwgt <- m1$weights\nrange(wgt)\nts.plot(wgt[1,], type = \"l\", ylab = \"Weight\", ylim = c(-0.5, 1.5))\nfor (i in 2:3) {\n  lines(wgt[i,], lty=i)\n}\n\n# Volatility Plot\nvol <- sqrt(m1$variances)\nrange(vol)\nts.plot(vol[,1], type = \"l\", ylab = \"Volatility\", ylim = c(0, 0.1))\nfor (i in 2:3) {\n  lines(vol[,i], lty = i)\n}\n\n# 5)  Consider the daily returns of Apple stock from January 2, 2001 to December\n#     31, 2010. The data are available from the file d-a2a-0110.txt. Build a Gaussian\n#     GARCH(1,1) model for the daily log returns. Assume that the risk free interest rate\n#     is 1% per annum and the current price of the stock is $350. Use simulation to\n#     compute the prices of a European call and an Asian call if the strike price is\n#     $355 and the time to expiration is 10 trading days.\n\naapl <- log(da$AAPL + 1)\nm.aapl <- garchFit(~garch(1,1), data = aapl, trace = F)\npredict(m.aapl, n.ahead = 10)\n\n# Black-Scholes Option Pricing\nS <- 350\nr <- 0.01\nK <- 355\nl <- 10\nsigma <- 0.01388\n\n# S: current price of stock\n# r: risk-free interest rate\n# K: strike price\n# l: time to expiration (in days)\n# sigma: conditional standard deviation of log return of stock\nblack.scholes <- function(S, r, K, l, sigma){\n  d1 <- (1 / (sigma * sqrt(l))) * (log(S / K) + (r + sigma^2/2) * (l))\n  d2 <- d1 - sigma * sqrt(l)\n  return(pnorm(d1) * S - pnorm(d2) * K * exp(-r * l))\n}\n\nmax <- black.scholes(S, r, K, l, sigma)\nfor (i in 1:10) {\n  sigma <- predict(m.aapl, n.ahead=10)[i, 3]\n  p <- black.scholes(S, r, K, l - i, sigma)\n  if (p > max) {\n    max <- p\n  }\n}\nmax\n",
    "created" : 1398840994643.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "505368971",
    "id" : "623D408F",
    "lastKnownWriteTime" : 1394056416,
    "path" : "~/Google Drive/ECON 371/ps3/ps3.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}